<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>سباق الحروف</title>

  <style>
    /* ✅ خط AA-GALAXY (ارفع الملف بجانب game.html) */
    @font-face{
      font-family:"AA-GALAXY";
      src:url("AA-GALAXY.otf") format("opentype");
      font-weight:normal;
      font-style:normal;
      font-display:swap;
    }

    :root{
      --bg1:#7a1f61;
      --bg2:#5d234a;
      --bg3:#3b1033;

      --white:#fff;
      --black:#111;
      --softWhite:rgba(255,255,255,.86);

      --pillBg: rgba(255,255,255,.10);
      --pillBg2: rgba(255,255,255,.14);

      --orange:#f28c00;
      --green:#1aa34a;
      --red:#e53935;

      --hexGreen:  rgba(0, 140, 70, .42);
      --hexOrange: rgba(255, 140, 0, .42);
      --hexPale:   rgba(255, 215, 80, .68);
      --hexBorder: rgba(0,0,0,.10);

      --timerFill:#b43d69;

      /* ✅ سماوي زر الأسئلة الخاصة */
      --cyan:#7fe7ff;
      --cyan2:#3bd6ff;
    }

    *{ box-sizing:border-box; }

    body{
      margin:0;
      color:#fff;
      text-align:center;
      font-family:"AA-GALAXY", Arial, sans-serif;
      background:
        radial-gradient(1200px 800px at 20% 10%, rgba(255,255,255,.12), transparent 60%),
        radial-gradient(900px 600px at 80% 30%, rgba(255,255,255,.08), transparent 55%),
        linear-gradient(135deg, var(--bg1) 0%, var(--bg2) 45%, var(--bg3) 100%);
      min-height:100vh;
    }

    a{color:inherit}

    /* ✅ هيدر مثل الصورة */
    header{
      padding:16px 14px 6px;
    }
    .headerRow{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
      width:100%;
      direction:ltr;
    }
    .logo{
      width:74px;height:74px;
      object-fit:contain;
      flex:0 0 auto;
    }
    h1{
      margin:0;
      flex:1 1 auto;
      text-align:center;
      color:#fff;
      font-size:52px;
      line-height:1.05;
      font-weight:900;
      text-shadow:0 10px 22px rgba(0,0,0,.35);
      direction:rtl;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      padding-top:6px;
    }
    .gameName{
      flex:0 0 auto;
      width:min(30vw, 190px);
      min-height:58px;
      padding:10px 10px;
      border-radius:10px;
      background:rgba(0,0,0,.10);
      border:5px solid rgba(0,0,0,.85);
      color:#fff;
      font-weight:900;
      line-height:1.15;
      text-align:center;
      overflow:hidden;
      direction:rtl;
      box-shadow:0 10px 22px rgba(0,0,0,.22);
    }
    .gameName:empty{display:none;}
    .gnText{
      display:-webkit-box;
      -webkit-box-orient:vertical;
      -webkit-line-clamp:2;
      overflow:hidden;
      word-break:break-word;
      white-space:normal;
      font-size:18px;
    }

    .wrap{width:95%;max-width:900px;margin:0 auto}

    /* ✅ الكرت الأساسي شفاف */
    .card{
      background:transparent;
      color:#fff;
      width:100%;
      margin:8px auto 0;
      padding:0;
      border-radius:0;
    }

    /* =========================
       Layout (Portrait/Landscape)
    ========================= */
    .gameLayout{
      width:min(92vw, 820px);
      margin:0 auto;
      display:flex;
      flex-direction:column;
      gap:10px;
      direction:rtl; /* عشان اليمين/اليسار في الوضع الأفقي */
    }
    .sideMap, .sideMain{ width:100%; }

    @media (orientation: landscape){
      .gameLayout{
        width:min(96vw, 1040px);
        max-width:1100px;
        flex-direction:row;
        align-items:flex-start;
        gap:14px;
      }
      .sideMap{ flex:0 0 52%; }
      .sideMain{ flex:1 1 auto; }
    }

    /* =========================
       MAP
    ========================= */
    .mapOuter{width:100%;display:flex;justify-content:center}
    .mapScale{
      width:min(92vw, 760px);
      transform:scale(var(--zoom, 1));
      transform-origin:center top;
    }
    .mapBox{
      position:relative;
      width:100%;
      border-radius:8px;
      overflow:hidden;
      background:transparent;
      border:10px solid rgba(242,140,0,.95); /* إطار برتقالي مثل الصورة */
      box-shadow:0 14px 28px rgba(0,0,0,.25);
    }
    .mapBox img{
      width:100%;
      height:auto;
      display:block;
      object-fit:unset;
      background:#0b7a2a;
    }

    .overlaySvg{
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      pointer-events:auto;
    }
    .overlaySvg .cell{
      cursor:pointer;
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
      stroke: var(--hexBorder);
      stroke-width: 1;
    }
    .overlaySvg .state0{ fill: rgba(0,0,0,0.001); }
    .overlaySvg .state1{ fill: var(--hexPale); }
    .overlaySvg .state2{ fill: var(--hexGreen); }
    .overlaySvg .state3{ fill: var(--hexOrange); }

    @keyframes palePulse {
      0%   { opacity: 1; }
      50%  { opacity: .35; }
      100% { opacity: 1; }
    }
    .overlaySvg .state1.pulse { animation: palePulse 0.9s ease-in-out infinite; }

    /* =========================
       أدوات تحت الخريطة (مثل الصورة)
       ترتيب من اليمين لليسار:
       Zoom -> Map -> Clear -> QMode -> Settings
    ========================= */
    .mapToolsRow{
      margin:12px auto 8px;
      width:min(92vw, 760px);
      display:flex;
      align-items:center;
      justify-content:center;
      gap:14px;
      direction:rtl;
      flex-wrap:wrap;
    }

    .toolBtn{
      width:54px;height:54px;
      border:none;
      border-radius:50%;
      background:#fff;
      color:#000;
      display:flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      box-shadow:0 8px 18px rgba(0,0,0,.20);
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
      border:3px solid rgba(0,0,0,.10);
      position:relative; /* ✅ عشان علامة ? */
      overflow:visible;
    }
    .toolBtn:active{ transform: translateY(1px); box-shadow:0 6px 16px rgba(0,0,0,.20); }
    .toolBtn svg{ width:28px;height:28px; fill:#111; }
    .toolBtn .txtIcon{ font-size:30px; font-weight:900; line-height:1; }

    /* ✅ زر نوع الأسئلة: سماوي عند الأسئلة الخاصة */
    .toolBtn.cyan{
      background: linear-gradient(180deg, var(--cyan) 0%, var(--cyan2) 100%);
      border-color: rgba(0,0,0,.18);
    }
    .toolBtn.cyan svg{ fill:#08303a; }
    .toolBtn.cyan .txtIcon{ color:#08303a; }

    /* ✅ علامة (?) باهتة */
    .helpDot{
      position:absolute;
      top:-6px;
      left:-6px;
      width:18px;height:18px;
      border-radius:50%;
      background:rgba(255,255,255,.55);
      border:2px solid rgba(0,0,0,.20);
      color:rgba(0,0,0,.55);
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:12px;
      font-weight:900;
      line-height:1;
      cursor:pointer;
      box-shadow:0 6px 14px rgba(0,0,0,.18);
      user-select:none;
    }
    .helpDot:active{ transform: translateY(1px); }

    /* نافذة شرح */
    .helpPopover{
      position:fixed;
      z-index:99999;
      max-width:min(280px, 86vw);
      padding:10px 12px;
      border-radius:14px;
      background:rgba(255,255,255,.96);
      border:4px solid rgba(0,0,0,.85);
      box-shadow:0 16px 30px rgba(0,0,0,.25);
      color:#111;
      text-align:right;
      font-weight:900;
      font-size:14px;
      line-height:1.5;
      display:none;
    }

    .zoomWrap{
      display:flex;
      align-items:center;
      justify-content:center;
      width:min(360px, 86vw);
      padding:8px 10px;
      border-radius:14px;
      background:transparent;
    }

    /* ✅ شكل السلايدر مثل الصورة (شريط أبيض + مقبض أسود مستطيل) */
    input[type="range"]{
      -webkit-appearance:none;
      appearance:none;
      width:100%;
      height:8px;
      border-radius:999px;
      background:rgba(255,255,255,.70);
      outline:none;
      box-shadow:0 6px 14px rgba(0,0,0,.18);
    }
    input[type="range"]::-webkit-slider-thumb{
      -webkit-appearance:none;
      appearance:none;
      width:26px;
      height:26px;
      border-radius:6px;
      background:#111;
      border:3px solid rgba(255,255,255,.80);
      box-shadow:0 6px 14px rgba(0,0,0,.25);
      cursor:pointer;
    }
    input[type="range"]::-moz-range-thumb{
      width:26px;height:26px;border-radius:6px;
      background:#111;border:3px solid rgba(255,255,255,.80);
      cursor:pointer;
    }
    input[type="range"]::-moz-range-track{
      height:8px;border-radius:999px;background:rgba(255,255,255,.70);
    }

    /* =========================
       لوحة النتائج (Scoreboard)
    ========================= */
    .scoreBar{
      width:100%;
      margin:6px auto 10px;
      display:flex;
      align-items:center;
      justify-content:center;
      gap:10px;
      direction:rtl;
    }
    .teamPill{
      min-width:170px;
      height:52px;
      border-radius:999px;
      display:flex;
      align-items:center;
      justify-content:center;
      font-weight:900;
      font-size:24px;
      color:#fff;
      border:4px solid rgba(0,0,0,.55);
      box-shadow:0 10px 22px rgba(0,0,0,.22);
      padding:0 14px;
      white-space:nowrap;
    }
    .teamPill.orange{ background:rgba(242,140,0,.95); }
    .teamPill.green{ background:rgba(26,163,74,.95); }

    .scoreBox{
      width:64px;
      height:64px;
      border-radius:18px;
      border:6px solid rgba(0,0,0,.85);
      background:#fff;
      color:#111;
      font-weight:900;
      font-size:34px;
      display:flex;
      align-items:center;
      justify-content:center;
      box-shadow:0 12px 24px rgba(0,0,0,.22);
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
      user-select:none;
    }
    button.scoreBox{ cursor:pointer; }
    .scoreBox.readonly{ opacity:.95; }

    /* نافذة اختيار رقم النقاط */
    .scoreBackdrop{
      position:fixed;
      inset:0;
      background:rgba(0,0,0,.45);
      display:none;
      align-items:center;
      justify-content:center;
      z-index:99998;
      padding:14px;
    }
    .scoreModal{
      width:min(92vw, 560px);
      background:#fff;
      color:#111;
      border-radius:20px;
      border:8px solid rgba(0,0,0,.85);
      box-shadow:0 18px 34px rgba(0,0,0,.30);
      padding:14px 14px 16px;
      text-align:center;
    }
    .scoreTitle{
      font-weight:900;
      font-size:22px;
      margin:4px 0 10px;
    }
    .scoreGrid{
      display:grid;
      grid-template-columns: repeat(6, 1fr);
      gap:10px;
      direction:ltr;
    }
    .scorePick{
      height:56px;
      border-radius:16px;
      border:5px solid rgba(0,0ڍ,0,.85);
      background:#fff;
      font-weight:900;
      font-size:24px;
      cursor:pointer;
      box-shadow:0 10px 22px rgba(0,0,0,.18);
      font-family:"AA-GALAXY", Arial, sans-serif;
    }
    .scorePick:active{ transform: translateY(1px); }

    /* =========================
       شريط اسم أول لاعب (مثل الصورة)
    ========================= */
    .firstPressBar{
      margin:8px auto 10px;
      width:100%;
      border-radius:999px;
      padding:14px 14px;
      background:rgba(255,255,255,.10);
      border:4px solid rgba(255,255,255,.70);
      color:#fff;
      font-weight:900;
      font-size:22px;
      box-shadow:0 10px 22px rgba(0,0,0,.22);
    }
    .firstPressBar.filled{
      border-color: rgba(255,255,255,.80);
      color:#fff;
    }

    /* =========================
       صف الأزرار + المؤقت (مثل الصورة)
    ========================= */
    .controlRow{
      width:100%;
      margin:0 auto 10px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:14px;
    }

    .pillBtn{
      flex:1 1 0;
      height:72px;
      border-radius:999px;
      background:rgba(255,255,255,.12);
      border:4px solid rgba(255,255,255,.75);
      color:#fff;
      font-size:26px;
      font-weight:900;
      cursor:pointer;
      box-shadow:0 10px 22px rgba(0,0,0,.22);
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
      padding:0 18px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      font-family:"AA-GALAXY", Arial, sans-serif;
    }
    .pillBtn:active{ transform: translateY(1px); box-shadow:0 8px 18px rgba(0,0,0,.22); }

    /* المؤقت وسط */
    .timerWrap{ flex:0 0 auto; display:flex; justify-content:center; align-items:center; }
    .timerClockBtn{
      width:134px;height:134px;
      border:none;
      background:transparent;
      border-radius:50%;
      cursor:pointer;
      position:relative;
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
      user-select:none;
      font-family:"AA-GALAXY", Arial, sans-serif;
    }
    /* حلقة خارجية بيضاء */
    .timerClockBtn::before{
      content:"";
      position:absolute;
      inset:0;
      border-radius:50%;
      border:6px solid rgba(255,255,255,.85);
      box-shadow:0 12px 26px rgba(0,0,0,.28);
    }
    /* تعبئة داخلية وردية */
    .timerClockBtn::after{
      content:"";
      position:absolute;
      inset:14px;
      border-radius:50%;
      background:var(--timerFill);
    }

    /* حلقة التناقص (موجودة) */
    .timerRing{
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      transform: rotate(-90deg);
      pointer-events:none;
      z-index:2;
      opacity:0;
    }
    .timerRing circle{
      fill: transparent;
      stroke: rgba(255,255,255,.95);
      stroke-width: 8;
      stroke-linecap: round;
      transition: stroke-dashoffset .20s linear;
    }

    .timerNumber{
      position:absolute;
      inset:0;
      display:flex;
      align-items:center;
      justify-content:center;
      font-weight:900;
      color:#fff;
      font-size:52px;
      z-index:3;
      text-shadow:0 10px 24px rgba(0,0,0,.35);
    }
    .timerPlayerView{ pointer-events:none; user-select:none; opacity:1; }

    /* =========================
       بطاقة السؤال (مثل الصورة)
    ========================= */
    .questionCard{
      width:100%;
      margin:10px auto 6px;
      background:#fff;
      color:#111;
      border-radius:28px;
      border:10px solid rgba(0,0,0,.88);
      box-shadow:0 18px 34px rgba(0,0,0,.30);
      padding:22px 16px 18px;
      text-align:center;
    }

    /* ✅ لون السؤال أصبح أسود */
    .qText{
      color:#111;
      font-size:34px;
      font-weight:900;
      line-height:1.35;
      margin:0 0 14px;
    }

    /* ✅ زر الجواب التفاعلي */
    .answerBtn{
      width:min(360px, 92%);
      height:70px;
      border-radius:999px;
      border:none;
      color:#fff;
      font-size:26px;
      font-weight:900;
      cursor:pointer;
      box-shadow:0 12px 24px rgba(0,0,0,.22);
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
      padding:0 16px;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      font-family:"AA-GALAXY", Arial, sans-serif;
    }
    .answerBtn:active{ transform: translateY(1px); box-shadow:0 10px 20px rgba(0,0,0,.22); }
    .answerBtn.disabled{ opacity:.45; cursor:not-allowed; }

    .answerBtn.answerHidden{ background:#ff2a2a; }
    .answerBtn.answerShown{ background:rgba(26,163,74,.98); }

    /* =========================
       صفحات الانتظار/اللوبي تبقى شغالة
    ========================= */
    .row{display:flex;gap:10px;flex-wrap:wrap;justify-content:center;align-items:center}
    .btn{padding:12px 14px;font-size:18px;border:none;border-radius:16px;cursor:pointer;font-family:"AA-GALAXY", Arial, sans-serif}
    .btnYellow{background:#fff;color:#111;border:4px solid rgba(0,0,0,.85); box-shadow:0 10px 22px rgba(0,0,0,.22);}
    .btnGreen{background:rgba(26,163,74,.95);color:#fff}
    .btnRed{background:rgba(224,57,53,.95);color:#fff}
    .btnOrange{background:rgba(242,140,0,.95);color:#fff}

    .smallNote{font-size:14px;opacity:.9;margin-top:8px}
    .codeBox{font-size:18px}
    .codeNum{font-size:34px;font-weight:900;letter-spacing:2px}

    .teams{display:flex;gap:10px;flex-wrap:wrap}
    .teamCol{flex:1;min-width:240px;border-radius:16px;padding:10px;color:#fff}
    .teamGreen{background:rgba(26,163,74,.65)}
    .teamOrange{background:rgba(242,140,0,.65)}
    .teamTitle{font-weight:900;margin-bottom:8px}
    .playerItem{
      background:rgba(255,255,255,.18);
      padding:10px;border-radius:14px;margin:6px 0;cursor:pointer
    }

    .waitingLayout{
      width:min(92vw, 760px);
      margin:12px auto 0;
      padding:16px;
      border-radius:22px;
      background:rgba(255,255,255,.10);
      border:4px solid rgba(255,255,255,.35);
      box-shadow:0 14px 28px rgba(0,0,0,.22);
      display:flex;
      flex-direction:column;
      min-height:52vh;
      justify-content:center;
      gap:14px;
    }

    .buyNowWrap{display:flex;justify-content:center;margin-top:10px}
    .buyNowBtn{
      width:min(92vw, 520px);
      padding:14px 16px;
      border:none;
      border-radius:18px;
      background:rgba(255,255,255,.92);
      color:#111;
      font-size:20px;
      font-weight:900;
      cursor:pointer;
      box-shadow:0 10px 22px rgba(0,0,0,.22);
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
      border:5px solid rgba(0,0,0,.85);
      font-family:"AA-GALAXY", Arial, sans-serif;
    }

    .playerBtnWrap{margin-top:14px}
    .playerBigBtn{
      width:min(92vw, 520px);
      height:110px;
      border:none;border-radius:20px;
      background:rgba(224,57,53,.95);
      cursor:pointer;
      display:flex;
      align-items:center;
      justify-content:center;
      color:#fff;
      font-size:28px;
      font-weight:900;
      letter-spacing:.2px;
      box-shadow:0 14px 28px rgba(0,0,0,.25);
      font-family:"AA-GALAXY", Arial, sans-serif;
    }
    .disabled{opacity:.5;cursor:not-allowed}

    /* ✅ أسفل الصفحة مثل الصورة */
    .bottomBar{
      width:95%;
      max-width:900px;
      margin:18px auto 14px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding:0 4px;
    }
    .homeBtn{
      border:none;
      border-radius:999px;
      padding:14px 20px;
      background:rgba(255,255,255,.92);
      color:#111;
      font-size:22px;
      font-weight:900;
      cursor:pointer;
      box-shadow:0 12px 24px rgba(0,0,0,.22);
      border:5px solid rgba(0,0,0,.85);
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
      font-family:"AA-GALAXY", Arial, sans-serif;
    }
    /* ✅ عبارة الحقوق (أصغر + أخف) */
    .rightsTxt{
      font-size:13px;
      opacity:.55;
      text-align:right;
      padding-right:6px;
      white-space:nowrap;
    }

    /* مودالات المشاركة / أسئلة المقدم / الإعدادات (كما هي لكن لا نخرب التصميم) */
    .shareBackdrop,.cqBackdrop,.settingsBackdrop{
      position:fixed; inset:0; background:rgba(0,0,0,.45);
      display:none; align-items:center; justify-content:center;
      z-index:9999; padding:14px;
    }
    .shareModal,.cqModal{
      width:min(92vw, 680px);
      background:#fff; color:#111;
      border-radius:18px; padding:14px; text-align:right; position:relative;
      border:6px solid rgba(0,0,0,.85);
      box-shadow:0 18px 34px rgba(0,0,0,.30);
      font-family:"AA-GALAXY", Arial, sans-serif;
    }
    .shareClose{
      position:absolute; left:10px; top:10px; border:none; background:transparent;
      font-size:26px; cursor:pointer;
    }
    .shareTitle{font-weight:900;margin:0 0 10px;text-align:center}
    .shareChoices{display:flex;gap:10px;flex-wrap:wrap;justify-content:center;margin:10px 0 8px}
    .sharePanel{
      display:none;
      background:rgba(0,0,0,.04);
      border:2px solid rgba(0,0,0,.10);
      border-radius:14px;
      padding:12px;
      text-align:center;
    }
    .shareCodeBig{font-size:34px;font-weight:900;letter-spacing:2px;text-align:center;margin:6px 0 0}
    .qrImg{width:220px;height:220px;display:block;margin:0 auto;border-radius:12px;background:#fff}
    .shareSmall{font-size:12px;opacity:.85;text-align:center;margin-top:8px;word-break:break-all}

    .cqCloseRed{
      position:absolute; left:10px; top:10px;
      width:40px;height:40px;border:none;border-radius:12px;
      background:rgba(224,57,53,.95);color:#fff;font-size:22px;font-weight:900;cursor:pointer;
      display:flex;align-items:center;justify-content:center;
      font-family:"AA-GALAXY", Arial, sans-serif;
    }
    .cqTitle{font-weight:900;margin:0 0 10px;text-align:center}
    .cqHint{font-size:12px;opacity:.85;text-align:center;margin:0 0 12px}

    .cqItem{border:2px solid rgba(0,0,0,.10);border-radius:14px;padding:8px 10px;margin:10px 0;background:rgba(0,0,0,.03)}
    .cqItem summary{cursor:pointer;font-weight:900;list-style:none;outline:none}
    .cqItem summary::-webkit-details-marker{display:none}

    .cqPair{border:2px solid rgba(0,0,0,.10);border-radius:14px;padding:10px;background:#fff;margin-top:10px}
    .cqLbl{font-weight:900;margin:0 0 6px;text-align:right}
    .cqTA{
      width:100%;
      padding:10px 10px;
      border-radius:14px;
      border:2px solid rgba(0,0,0,.12);
      font-size:15px;
      line-height:1.5;
      resize:none;
      outline:none;
      background:#fff;
      margin:0 0 10px;
      font-family:"AA-GALAXY", Arial, sans-serif;
    }
    .cqAddBtn{
      width:56px;height:48px;border:none;border-radius:14px;
      background:rgba(180,61,105,.95);color:#fff;font-size:26px;font-weight:900;cursor:pointer;
      box-shadow:0 10px 22px rgba(0,0,0,.22);
      font-family:"AA-GALAXY", Arial, sans-serif;
    }
    .cqAddWrap{display:flex;justify-content:center;margin-top:2px}
    .cqSaveFixed{
      position:sticky; bottom:10px; margin:10px auto 0;
      width:min(240px, 72%);
      border-radius:14px;
      font-weight:900;
      box-shadow:0 10px 22px rgba(0,0,0,.22);
      font-family:"AA-GALAXY", Arial, sans-serif;
    }
    .cqSavedMsg{font-size:12px;opacity:.9;text-align:center;margin-top:8px}

    .settingsPanel{
      width:min(78vw, 360px);
      height:min(72vh, 560px);
      background: rgba(255,255,255,.92);
      border-radius:26px;
      border:8px solid rgba(0,0,0,.85);
      box-shadow:0 16px 30px rgba(0,0,0,.25);
      padding:18px 14px;
      display:flex;
      flex-direction:column;
      gap:18px;
      color:#111;
      font-family:"AA-GALAXY", Arial, sans-serif;
    }
    #settingsMenu{display:flex;flex-direction:column;gap:14px}
    .settingsBtn{
      width:100%;height:64px;border-radius:22px;border:4px solid rgba(0,0,0,.85);
      background:#fff;color:#111;font-weight:900;font-size:28px;cursor:pointer;
      box-shadow:0 6px 0 rgba(0,0,0,.18);
      font-family:"AA-GALAXY", Arial, sans-serif;
    }
    .settingsView{
      display:none;width:100%;height:100%;overflow:auto;background:#fff;border-radius:18px;
      border:3px solid rgba(0,0,0,.25);padding:14px;color:#111;text-align:right
    }
    .settingsView h3{margin:0 0 10px;text-align:center}
    .settingsBackMini{
      width:100%;height:52px;border-radius:18px;border:3px solid rgba(0,0,0,.65);
      background:#fff;font-weight:900;cursor:pointer;margin-top:10px;font-family:"AA-GALAXY", Arial, sans-serif;
    }
    .timerMiniPicker{
      display:none;width:100%;border-radius:18px;border:3px solid rgba(0,0,0,.65);
      background:#fff;padding:10px;
    }
    .timerMiniList{display:flex;flex-direction:column;gap:10px}
    .timerMiniItem{
      height:52px;border-radius:16px;border:3px solid rgba(0,0,0,.25);background:#fff;
      font-weight:900;font-size:22px;cursor:pointer;font-family:"AA-GALAXY", Arial, sans-serif;
    }

    /* =========================
       احتفال الفوز
    ========================= */
    .winBackdrop{
      position:fixed;
      inset:0;
      background:rgba(0,0,0,.55);
      display:none;
      align-items:center;
      justify-content:center;
      z-index:99997;
      padding:14px;
    }
    .winCard{
      width:min(92vw, 680px);
      border-radius:28px;
      border:10px solid rgba(0,0,0,.88);
      background:rgba(255,255,255,.96);
      box-shadow:0 20px 36px rgba(0,0,0,.32);
      padding:26px 18px 22px;
      text-align:center;
      color:#111;
      position:relative;
      overflow:hidden;
      font-family:"AA-GALAXY", Arial, sans-serif;
    }
    .winTitle{
      font-weight:900;
      font-size:34px;
      line-height:1.2;
      margin:0 0 10px;
    }
    .winSub{
      font-weight:900;
      font-size:20px;
      opacity:.85;
      margin:0;
    }
    .winRibbon{
      position:absolute;
      left:-20px;
      top:-20px;
      width:140px;
      height:140px;
      border-radius:50%;
      opacity:.12;
    }
    .winConfetti{
      position:absolute;
      inset:-20px;
      pointer-events:none;
      opacity:.75;
      filter: blur(.2px);
    }
    .confettiPiece{
      position:absolute;
      width:10px;
      height:18px;
      border-radius:4px;
      opacity:.9;
      animation: fall 1.6s linear infinite;
    }
    @keyframes fall{
      0%{ transform: translateY(-40px) rotate(0deg); opacity:.9; }
      100%{ transform: translateY(520px) rotate(260deg); opacity:.85; }
    }
  </style>
</head>

<body>
  <header>
    <div class="headerRow">
      <img class="logo" src="logo.png" alt="شعار صندوق المسابقات">
      <h1>سباق الحروف</h1>
      <div id="gameName" class="gameName"></div>
    </div>
  </header>

  <div class="wrap">
    <div id="main" class="card">جاري التحميل...</div>

    <!-- ✅ أسفل الصفحة مثل الصورة -->
    <div class="bottomBar">
      <button class="homeBtn" onclick="location.href='index.html'">الرئيسية</button>
      <div class="rightsTxt">© جميع الحقوق محفوظة لمتجر صندوق المسابقات</div>
    </div>
  </div>

  <!-- ✅ نافذة شرح الأزرار -->
  <div id="helpPopover" class="helpPopover"></div>

  <!-- ✅ اختيار النقاط -->
  <div id="scoreBackdrop" class="scoreBackdrop">
    <div class="scoreModal" role="dialog" aria-modal="true" aria-label="اختيار النقاط">
      <div id="scoreTitle" class="scoreTitle">اختر النقاط</div>
      <div id="scoreGrid" class="scoreGrid"></div>
    </div>
  </div>

  <!-- ✅ احتفال الفوز -->
  <div id="winBackdrop" class="winBackdrop">
    <div class="winCard" role="dialog" aria-modal="true" aria-label="احتفال الفوز">
      <div id="winRibbon" class="winRibbon"></div>
      <div id="winConfetti" class="winConfetti"></div>
      <div id="winTitle" class="winTitle">مبروك الفوز</div>
      <p id="winSub" class="winSub"></p>
    </div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-app.js";
    import { getDatabase, ref, onValue, update, runTransaction } from "https://www.gstatic.com/firebasejs/10.12.5/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDy2FEg8Xj0pA05syDawTh37rI1NEbQTjQ",
      authDomain: "sabaq-alhorof.firebaseapp.com",
      databaseURL: "https://sabaq-alhorof-default-rtdb.europe-west1.firebasedatabase.app",
      projectId: "sabaq-alhorof",
      storageBucket: "sabaq-alhorof.firebasestorage.app",
      messagingSenderId: "1053646928152",
      appId: "1:1053646928152:web:032d50148c3a4f1148066d"
    };

    const MAPS = [
      [
        ["ش","أ","ث","د","هـ"],
        ["ي","ح","ض","ن","ك"],
        ["غ","ظ","ق","ر","ع"],
        ["ص","ز","س","ط","و"],
        ["ذ","ل","ب","م","ج"]
      ],
      [
        ["ق","ص","و","د","ب"],
        ["ح","ي","ض","هـ","ث"],
        ["ك","ط","ش","ز","م"],
        ["أ","ر","س","ظ","ث"],
        ["ذ","غ","هـ","ع","ج"]
      ],
      [
        ["ذ","ج","أ","ب","ر"],
        ["ي","ح","ز","ل","س"],
        ["ث","ظ","ق","ض","ع"],
        ["ص","ن","د","ط","غ"],
        ["ك","خ","هـ","م","و"]
      ]
    ];

    const QUESTIONS = {};
    const ALL_LETTERS = Array.from(new Set(MAPS.flat(2)));
    for(const L of ALL_LETTERS){
      QUESTIONS[L] = Array.from({length:25}, (_,i) => ({
        q: `(${i+1}) سؤال لحرف ${L}`,
        a: `${L}...`
      }));
    }

    QUESTIONS["هـ"] = [
      { q: "هي البنيه او الاطار الذي يستخدم لدعم شيئ ما ويمكن ان يكون معنوياً مثل المباني او معنوياً مثل (……..)", a: "هيكل" },
      { q: "هو مايهدى من الانعام الى الحرم تقرباً الى الله", a: "هدي" },
      { q: "هو نوع من الشعر نقيض المديح ويُكتب عندما الشاعر يعبر عن سخطة واشمئزازه", a: "هجاء" },
      { q: "هو نبات عطري يُستخدم في الطبخ والقهوة ويُعرف بـ \"ملك التوابل\"؟", a: "هيل" },
      { q: "هي مدينة يابانية تعرضت لأول قنبلة ذرية", a: "هيروشيما" },
      { q: "من هو النبي الذي ارسله الله الى قوم عاد؟", a: "هود عليه السلام" },
      { q: "من أول من سعى بين الصفا و المروة ؟", a: "هاجر ام اسماعيل عليه السلام" },
      { q: "هي صفة بين المشي والركض", a: "هروله" },
      { q: "هو الكلام الفارغ الذي لا معنى له", a: "هراء" },
      { q: "هي كلمة في اللغة العربية تعني اعطاء الشخص ماله لشخص اخر بلا عوض", a: "هبه" },
      { q: "ماذا يطلق على صوت الموج", a: "هدير" },
      { q: "هو موقع شهير على شبكة اﻹنترنت خاص بإنشاء بريد إلكتروني مجاني", a: "هوتميل" },
      { q: "هو مسلسل كرتوني قديم معروف عند الطيبين يبدأ اسمه بحرف هـ", a: "هزيم الرعد" },
      { q: "هي هضبة تقع في وسط المملكة العربية السعودية", a: "هضبة نجد" },
      { q: "هي الحالة التي يشعر بها الانسان عندما يصبح خائفاً", a: "هلع" },
      { q: "شخصية من شخصيات الممثل عبدالله السدحان في مسلسل طاش ماطاش", a: "هدبدب" },
      { q: "هو لقب يطلق على قمة سلسلة جبال معروفة عالمياً", a: "هملايا" },
      { q: "هو غاز خفيف جداً وغير قابل للاشتعال ويستخدم في المناطيد", a: "هيليوم" },
      { q: "مدينة ألمانية تعتبر من أهم الموانئ الأوروبية", a: "هامبورغ" },
      { q: "هي نوبات من الانفعالات الشديدة او الضحك والبكاء غير المنضبط", a: "هستيريا" },
      { q: "هو اسم يطلق على الاشخاص اللذين يتركون وطنهم للعيش في بلد آخر", a: "هجرة" },
      { q: "هي نشاط منتظم يمارسه الشخص في وقت فراغة گ/ الرسم او الطبخ الخ…", a: "هوايه" },
      { q: "هو المطر الخفيف المتواصل الذي يهطل على دفعات", a: "هتان" },
      { q: "هي ولاية امريكية تتكون من عدة جز وتقع في المحيط الهادئ", a: "هاواي" },
      { q: "هو ممر مائي ضيق يربط الخليج العربي بخليج عُمان يسمى مضيق ……..؟", a: "هرمز" }
    ];

    QUESTIONS["د"] = [
      { q: "هي قول يطلب به الإنسان إثبات حق على على الغير في المحاكم", a: "دعوى" },
      { q: "من هو مخترع الاطارات المنفوخة للسيارات", a: "جون بويد دنلوب" },
      { q: "هو القانون الأساسي الذي يحدد نظام الحكم في الدولة ويحدد حقوق وواجبات المواطنين", a: "دستور" },
      { q: "يسمى النظام السياسي الذي يتميز بحكم الشعب …..", a: "ديمقراطية" },
      { q: "ماهو اسم اول عملة اسلامية في التاريخ", a: "دينار" },
      { q: "هو الزمن الطويل او مدة الحياة كلها", a: "دهر" },
      { q: "ماهي عاصمة دولة السنغال", a: "داكار" },
      { q: "هو سواد الليل وضلمته", a: "دجى" },
      { q: "هو ماء لم يخرج من الارض ولم ينزل من السماء", a: "دموع" },
      { q: "هو المخادع أو المحتال في أقواله وافعاله", a: "دجال" },
      { q: "هو الاحتيال والخداع وتدبير الشر بمهارة", a: "هدير" },
      { q: "هي صفه تمزج بين الفطنة والذكاء وإدراك الامور", a: "دهاء" },
      { q: "ماهي عاصمة دولة تنزانيا", a: "دار السلام" },
      { q: "من مدن جمهورية مصر العرب", a: "دمياط" },
      { q: "هو صغير الدب", a: "ديسم" },
      { q: "هو الطائر الذي يكنى بأبي اليقضات", a: "ديك" },
      { q: "ماهي عاصمة ايرلندا", a: "دبلن" },
      { q: "ماهو الشيء الذي الذي ليس له نقطة بداية ولايحتوي على نهاية", a: "دائرة" },
      { q: "هو المرض و العلة", a: "داء" },
      { q: "ماهو الحيوان البحري الذي وُصف بأنه اذكى مخلوقات البحر", a: "دولفين" },
      { q: "هو عكس كلمة فاتح", a: "داكن" },
      { q: "هي السحابة كثيرة المطر", a: "داجنة" },
      { q: "اكمل المثل : من خرج من……..قل مقداره", a: "داره" },
      { q: "اكمل المثل : لكل……..دواء", a: "داء" },
      { q: "هي مرادف كلمة ……إشارة", a: "دلالة" }
    ];

    QUESTIONS["أ"] = [
      { q: "وحدة لقياس شدة التيار الكهربائي", a: "أمبير" },
      { q: "من هو اول من جمع القرآن الكريم بين لوحين", a: "ابو بكر الصديق" },
      { q: "ماهو الكوكب الذي يُعرف بالكوكب الازرق", a: "الارض" },
      { q: "ماهو النبي الذي الذي أُطلق عليه لقب نبي الصبر", a: "أيوب عليه السلام" },
      { q: "هو غاز يتكون من ثلاثة ذرات أكسجين ويوجد في الغلاف الجوي للارض كطبقة مشهورة", a: "الاوزون" },
      { q: "ماهي عاصمة دولة الإمارات", a: "أبو ظبي" },
      { q: "من هو الرئيس الامريكي الذي اصدر اعلان التحرير", a: "أبراهام لينكولن" },
      { q: "سورة في القران الكريم طلق عليها اسم اخت الطويلتين", a: "الأعراف" },
      { q: "من هو الشاعر العربي الذي يعتبر أمير الشعراء", a: "أحمد شوقي" },
      { q: "ماهو اطول نهر في العالم بعد نهر النيل", a: "الأمازون" },
      { q: "ماهو الشخص الذي يرى صديقة وعدوه بعين واحدة", a: "الأعور" },
      { q: "ماهو الاسم الذي يُطلق على اسبانيا قديماً", a: "الأندلس" },
      { q: "ماهو الشيء الذي كلما تحرك خطوة فقد جزء من ذيله", a: "الإبرة" },
      { q: "ما هو اسم الانسجة التي تقوم على ربط العضلات بالعظام", a: "أوتار" },
      { q: "ماهو لون الزمرد", a: "أخضر" },
      { q: "ماهي عاصمة تركيا", a: "أنقرة" },
      { q: "ماهي الدولة التي فازت بأول نسخة لكأس العالم", a: "أوروغواي" },
      { q: "ماهو اسم الكوكب الذي ترتيبه الثالث من الكواكب الشمسيه", a: "الارض" },
      { q: "هي عاصمة اليونان", a: "أثينا" },
      { q: "هي اصغر قارة في العالم من حيث المساحة", a: "اوروبا" },
      { q: "ماهو اللون الناتج عن مزج اللون الاصفر والازرق", a: "اخضر" },
      { q: "هو مجال يهتم بحماية الأنظمة والشبكات والبرامج من الهجمات الرقمية", a: "الامن السيبراني" },
      { q: "اكمل المثل : القرد بعين ……..غزال", a: "أمه" },
      { q: "هو علم يهتم بدارسة الطبيعة والكائنات الحية", a: "أحياء" },
      { q: "ماهو معنى كلمة إماطة", a: "إزالة" }
    ];

    QUESTIONS["ث"] = [
      { q: "ماهو عدد الحروف في الأبجدية العربية", a: "ثمانية وعشرون حرفاً" },
      { q: "صفة من أهم صفات الشجاعة", a: "ثبات" },
      { q: "هو وصف يطلق على كثير الكلام", a: "ثرثار" },
      { q: "كم عدد كواكب المجموعة الشمسية", a: "ثمانية" },
      { q: "ماهو عدد اجزاء القرآن الكريم", a: "ثلاثون جزءً" },
      { q: "من اول الخطباء المسلمين ولُقب بخطيب الرسول", a: "ثابت بن قيس" },
      { q: "هو منطقة في الفضاء حيث الجاذبية قوية لدرجة انه لايستطيع احد الهروب منها ، حتى الضوء", a: "الثقب الاسود" },
      { q: "ماهو عدد اللاعبين في لعبة الكرة الحديدية", a: "ثلاثة لاعبين" },
      { q: "كم عدد فقرات العمود الفقري", a: "ثلاثة وثلاثون" },
      { q: "يطلق في اللغة العربية الفصحى على الجماعة من الناس", a: "ثُلة" },
      { q: "بلدة الرحالة العربي المشهور أحمد بن ماجد قرب الرياض (في السعودية)", a: "ثرمدا" },
      { q: "ماهو اسم السبعة نجوم المتلاصقة في السماء", a: "ثريا" },
      { q: "كم تستغرق الارض للدوران حول الشمس", a: "ثلاث مأئه وخمسة وستون يوماً" },
      { q: "كلمة تستطيع أن تقرأها من اليمين و الشمال", a: "ثلث" },
      { q: "هو مرض يصيب فروة شعر الانسان", a: "ثعلبة" },
      { q: "هو الطائر الذي يكنى بأبي اليقضات", a: "ديك" },
      { q: "اسم نبات يستخدم في الطب كمضاد للالتهاب", a: "ثوم" },
      { q: "هي مدينة سعودية ساحلية على البحر الاحمر", a: "ثول" },
      { q: "هو وفرة المال وكثرته", a: "ثراء" },
      { q: "مرادف كلمة وزن", a: "ثقل" },
      { q: "هو الماء المنهمر بغزارة و سيلانه شديد", a: "ثجاج" },
      { q: "ماهو الصوت التي تصدرة الشاة او الخروف في اللغة العربية", a: "ثغاء" },
      { q: "ماهو الاسم الاخير للحجاج بن يوسف", a: "الثقفي" },
      { q: "هو عكس كلمة متحرك", a: "ثابت" }
    ];

    QUESTIONS["ش"] = [
      { q: "هو يستعمل لتثبيت الشموع فيه للزينة", a: "شمعدان" },
      { q: "هو الماء الجاري والمتساقط من الجبل", a: "شلال" },
      { q: "ماهو اسم صغير الضفدع", a: "شرغوف" },
      { q: "ماهي السورة التي تسمى الجامعة", a: "الشعراء" },
      { q: "من هي المرأة التي حكمت مصر 80 يوماً بعد وفاة زوجها", a: "شجرة الدر" },
      { q: "هو الخصام والقطيعة بين فرد أو جماعة أخرى", a: "شقاق" },
      { q: "ماهو اسم السبت قبل الاسلام", a: "شيار" },
      { q: "هي القطع الصغيرة المتطايرة من قنبلة ما", a: "شظايا" },
      { q: "هو مايتطابر من النار", a: "شرارة" },
      { q: "هو اسم للضوء الذي ينطلق من مكان واحد باستقامه", a: "شعاع" },
      { q: "هو اسم من اسماء الصقور", a: "شاهين" },
      { q: "هو اسم يُطلق على البخيل الحريص على المال", a: "شحيح" },
      { q: "هي لعبة تُلعب على لوح يتكون من لونين فقط", a: "شطرنج" },
      { q: "ما هي احدى مراحل تطور الفراشة", a: "شرنقة" },
      { q: "هو اسم يُطلق على صغير الغزال", a: "شادن" },
      { q: "هي اوعية تنقل الدم من القلب الى جميع انحاء الجسم", a: "شرايين" },
      { q: "هو قطعة كبيرة من القماش يتم تعليقة في السفينة لصد الرياح", a: "شراع" },
      { q: "هو عكس كلمة ضعيف", a: "شديد" },
      { q: "هو عكس كلمة جبان", a: "شجاع" },
      { q: "هو مرادف لكلمة قاسٍ", a: "شرس" },
      { q: "هو اسم شارع في شهير في مدينة باريس", a: "شانزليزيه" },
      { q: "هي مدينة ساحلية في مصر", a: "شرم الشيخ" },
      { q: "هو مايطلق على الاخبار الكاذبة", a: "شائعات" },
      { q: "ما هي المادة تفرزها الاذن لحمايتها", a: "شمع" },
      { q: "هي مجموعة من العلوم الدينية التي تدرس وتفهم وتطبق أحكام الإسلام", a: "شريعة" }
    ];

    QUESTIONS["ك"] = [
      { q: "ماهو العنصر الكيميائي الذي له الرمز C", a: "كربون" },
      { q: "صفه اخرجت ابليس من الجنة", a: "الكبر" },
      { q: "هو شيء له جناحان ولاكن لايطير", a: "كتاب" },
      { q: "هو مجلس تصدر منه القرارات في الولايات المتحدة الامريكية", a: "كونغرس" },
      { q: "هي اقصر سورة في القرآن الكريم", a: "الكوثر" },
      { q: "هي وحدة قياس الكتلة", a: "كيلو" },
      { q: "هي الرياضة الرسمية في دولة المانيا", a: "كرة القدم" },
      { q: "هي اللعبة الاكثر تأثيراً وشعبية في دولة الهند", a: "كريكت" },
      { q: "ماهو اسم ابن النبي نوح الذي غرق في الطوفان", a: "كنعان" },
      { q: "هي عاصمة ماليزيا", a: "كوالالمبور" },
      { q: "هي عمل أوجبه ديننا الحنيف لمحو ذنب معين", a: "كفارة" },
      { q: "هو حبس الغضب الشديد وكتمه وعدم إظهاره", a: "كظم الغيظ" },
      { q: "هي جعبة صغيرة توضع فيها النبال او الاسهم", a: "كنانه" },
      { q: "هو قصد إيذاء الاخرين دون علمهم", a: "كيد" },
      { q: "هو اسم نهر في الجنة", a: "كوثر" },
      { q: "ما الحيوان الأليف الذي يُعَدّ وفيًّا ويُنعَت بأنّه أفضل صديق للإنسان؟", a: "كلب" },
      { q: "يست
