<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>عرض التلفاز - سباق الحروف</title>

  <!-- تقليل الكاش قدر الإمكان -->
  <meta http-equiv="Cache-Control" content="no-store, max-age=0" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />

  <style>
    :root{
      --bg:#7b1f63;
      --yellow:#f4c400;
      --white:#fff;
      --muted: rgba(255,255,255,.78);
      --shadow: 0 16px 40px rgba(0,0,0,.28);

      --green:#16a34a;
      --orange:#f28c00;

      --cell0:#ffffff;
      --cell1:#f4c400;
      --cell2:#16a34a;
      --cell3:#f28c00;
      --cellStroke: rgba(0,0,0,.28);
    }

    @font-face{
      font-family:"AA-GALAXY";
      src:url("AA-GALAXY.otf") format("opentype");
      font-display:swap;
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      min-height:100vh;
      background: var(--bg);
      color:#fff;
      font-family:"AA-GALAXY", Arial, sans-serif;
      overflow:hidden;
    }

    /* ===== Top Bar ===== */
    .topbar{
      height:74px;
      padding:10px 14px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
    }
    .brand{
      display:flex;
      align-items:center;
      gap:10px;
      min-width:120px;
    }
    .logo{
      width:44px;height:44px;object-fit:contain;
      filter: drop-shadow(0 8px 14px rgba(0,0,0,.25));
      user-select:none; pointer-events:none;
    }

    .centerTitle{
      flex:1;
      display:flex;
      justify-content:center;
      align-items:center;
      min-width:0;
    }
    .gameName{
      max-width:min(720px, 70vw);
      padding:10px 16px;
      border-radius:16px;
      background: rgba(0,0,0,.14);
      border:1px solid rgba(255,255,255,.18);
      box-shadow: var(--shadow);
      color: var(--yellow);
      font-size:26px;
      text-align:center;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    .rightTools{
      display:flex;
      align-items:center;
      gap:12px;
      min-width:280px;
      justify-content:flex-end;
    }

    .scores{
      display:flex;
      gap:10px;
      align-items:center;
    }
    .pill{
      display:flex;
      align-items:center;
      gap:10px;
      padding:10px 12px;
      border-radius:16px;
      background: rgba(0,0,0,.14);
      border:1px solid rgba(255,255,255,.18);
      box-shadow: var(--shadow);
      min-width:140px;
      justify-content:space-between;
      font-family: Arial, sans-serif;
      font-weight:900;
    }
    .pill .n{ font-size:22px; line-height:1; }
    .pill.green .n{ color: var(--green); }
    .pill.orange .n{ color: var(--orange); }
    .pill .t{
      font-size:14px;
      color: rgba(255,255,255,.92);
      font-weight:900;
      white-space:nowrap;
    }

    .zoomWrap{
      display:flex;
      align-items:center;
      gap:10px;
      padding:10px 12px;
      border-radius:16px;
      background: rgba(0,0,0,.14);
      border:1px solid rgba(255,255,255,.18);
      box-shadow: var(--shadow);
      font-family: Arial, sans-serif;
      font-weight:900;
    }
    .zoomWrap label{
      font-size:13px;
      color: rgba(255,255,255,.92);
      white-space:nowrap;
    }
    input[type="range"]{
      width:160px;
    }

    /* ===== Map Area ===== */
    main{
      height: calc(100vh - 74px);
      padding:10px 14px 16px;
      display:flex;
      align-items:center;
      justify-content:center;
    }

    .mapStage{
      width: min(1200px, 96vw);
      height: min(780px, calc(100vh - 110px));
      position:relative;
      display:flex;
      align-items:center;
      justify-content:center;
    }

    /* هذا هو “الصندوق” اللي نكبره/نصغره بس بدون ما يلمس الهيدر */
    .mapCanvas{
      --zoom: 1;
      width:100%;
      height:100%;
      position:relative;
      transform: scale(var(--zoom));
      transform-origin: top center;
    }

    /* صورة الخريطة */
    .mapBg{
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      object-fit:contain;
      user-select:none;
      pointer-events:none;
    }

    /* SVG الخلايا فوق الصورة */
    .mapSvg{
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      pointer-events:none;
    }

    .cellPoly{
      stroke: var(--cellStroke);
      stroke-width: 2;
      vector-effect: non-scaling-stroke;
    }
    .s0{ fill: var(--cell0); }
    .s1{ fill: var(--cell1); }
    .s2{ fill: var(--cell2); }
    .s3{ fill: var(--cell3); }

    .cellText{
      font-family: Arial, sans-serif;
      font-weight:900;
      fill:#111;
      text-anchor: middle;
      dominant-baseline: middle;
      user-select:none;
    }

    .status{
      position:absolute;
      right:10px;
      bottom:8px;
      font-family: Arial, sans-serif;
      font-size:12px;
      color: rgba(255,255,255,.78);
      text-shadow: 0 10px 18px rgba(0,0,0,.35);
      user-select:none;
    }

    /* ===== Setup / Blocked Overlays ===== */
    .overlay{
      position:fixed;
      inset:0;
      background: rgba(0,0,0,.55);
      display:flex;
      align-items:center;
      justify-content:center;
      padding:16px;
      z-index:999;
    }
    .modal{
      width:min(520px, 94vw);
      background: rgba(20, 8, 25, .92);
      border:1px solid rgba(255,255,255,.18);
      border-radius:18px;
      padding:16px 14px;
      box-shadow: 0 22px 70px rgba(0,0,0,.55);
      text-align:center;
    }
    .mTitle{
      margin:4px 0 10px;
      font-size:22px;
      color:var(--yellow);
    }
    .mHint{
      font-family: Arial, sans-serif;
      color:rgba(255,255,255,.82);
      font-size:13px;
      line-height:1.7;
      margin:0 0 12px;
    }
    .in{
      width: min(360px, 90vw);
      height:54px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.22);
      background: rgba(255,255,255,.10);
      color:#fff;
      padding:0 14px;
      font-size:18px;
      outline:none;
      text-align:center;
      font-family: Arial, sans-serif;
      font-weight:900;
      letter-spacing:2px;
      direction:ltr;
    }
    .btn{
      width: min(360px, 90vw);
      height:56px;
      border:none;
      border-radius:16px;
      background: var(--yellow);
      color:#111;
      font-size:18px;
      font-weight:900;
      cursor:pointer;
      margin-top:12px;
      font-family: Arial, sans-serif;
      box-shadow: 0 18px 40px rgba(0,0,0,.35);
    }
    .err{
      display:none;
      margin-top:10px;
      background:#fee2e2;
      border:1px solid #fecaca;
      color:#7a1a1a;
      padding:10px 12px;
      border-radius:14px;
      font-size:14px;
      text-align:center;
      font-family: Arial, sans-serif;
      font-weight:900;
    }

    @media (max-width: 820px){
      .topbar{ height:auto; padding:10px 10px; flex-wrap:wrap; }
      .rightTools{ min-width:unset; width:100%; justify-content:center; }
      main{ height: calc(100vh - 120px); }
      input[type="range"]{ width:140px; }
      .gameName{ font-size:22px; }
    }
  </style>
</head>

<body>
  <header class="topbar">
    <div class="brand">
      <img class="logo" src="logo.png" alt="شعار صندوق المسابقات" onerror="this.style.display='none'">
    </div>

    <div class="centerTitle">
      <div class="gameName" id="gameName">—</div>
    </div>

    <div class="rightTools">
      <div class="scores">
        <div class="pill green">
          <span class="t">الأخضر</span>
          <span class="n" id="scoreGreen">0</span>
        </div>
        <div class="pill orange">
          <span class="t">البرتقالي</span>
          <span class="n" id="scoreOrange">0</span>
        </div>
      </div>

      <div class="zoomWrap">
        <label for="zoomRange">تكبير</label>
        <input id="zoomRange" type="range" min="85" max="130" value="100">
      </div>
    </div>
  </header>

  <main>
    <div class="mapStage">
      <div class="mapCanvas" id="mapCanvas">
        <img class="mapBg" id="mapBg" alt="الخريطة">
        <svg class="mapSvg" id="mapSvg" viewBox="0 0 1000 700" preserveAspectRatio="xMidYMid meet" aria-label="خريطة الخلايا"></svg>
      </div>
      <div class="status" id="statusLine">—</div>
    </div>
  </main>

  <!-- Setup overlay -->
  <div class="overlay" id="setupOverlay" style="display:none">
    <div class="modal">
      <div class="mTitle">عرض التلفاز</div>
      <p class="mHint">اكتب رمز الغرفة (6 أرقام) ثم ابدأ العرض.</p>
      <input class="in" id="codeInput" maxlength="6" inputmode="numeric" placeholder="رمز الغرفة">
      <button class="btn" id="startBtn">ابدأ العرض</button>
      <div class="err" id="setupErr"></div>
    </div>
  </div>

  <!-- Blocked overlay -->
  <div class="overlay" id="blockedOverlay" style="display:none">
    <div class="modal">
      <div class="mTitle">عرض التلفاز مستخدم</div>
      <p class="mHint" id="blockedMsg">عرض التلفاز مفتوح على جهاز آخر لنفس الغرفة.</p>
      <button class="btn" id="reloadBtn">إعادة المحاولة</button>
    </div>
  </div>

  <script>
    const ASSET_VERSION = "2026-02-20-1";

    // ✅ كسر كاش رابط tv تلقائيًا (مرة وحدة)
    (function ensureV(){
      try{
        const u = new URL(location.href);
        if(!u.searchParams.get("v")){
          u.searchParams.set("v", ASSET_VERSION);
          location.replace(u.toString());
        }
      }catch(e){}
    })();

    function normalizeDigits(s){
      const map = {
        "٠":"0","١":"1","٢":"2","٣":"3","٤":"4","٥":"5","٦":"6","٧":"7","٨":"8","٩":"9",
        "۰":"0","۱":"1","۲":"2","۳":"3","۴":"4","۵":"5","۶":"6","۷":"7","۸":"8","۹":"9"
      };
      return String(s || "").replace(/[٠-٩۰-۹]/g, d => map[d] ?? d);
    }
    function cleanCode(s){
      return normalizeDigits(s).replace(/\D/g, "").slice(0,6);
    }

    function ensureDeviceId(){
      const key = "sandooq_device_id_v1";
      let id = "";
      try{ id = localStorage.getItem(key) || ""; }catch(e){}
      if(!id){
        try{
          id = (crypto?.randomUUID ? crypto.randomUUID() : ("tv_" + Math.random().toString(16).slice(2) + Date.now().toString(16)));
        }catch(e){
          id = ("tv_" + Math.random().toString(16).slice(2) + Date.now().toString(16));
        }
        try{ localStorage.setItem(key, id); }catch(e){}
      }
      return id;
    }

    // ✅ Sync base (Cloudflare Worker + Durable Objects)
    const qs0 = new URLSearchParams(location.search);
    const SYNC_BASE = (qs0.get("sync") || "https://horof-sync.sandooq-m.workers.dev").replace(/\/$/,"");

    async function fetchJSON(url, opts){
      const r = await fetch(url, opts);
      const j = await r.json().catch(()=>null);
      return { ok: r.ok, status: r.status, json: j };
    }
    async function fetchRoom(code){
      const url = `${SYNC_BASE}/state?room=${encodeURIComponent(code)}`;
      const { json } = await fetchJSON(url, { cache:"no-store" });
      if(!json || !json.ok) throw new Error("STATE_FAIL");
      return (json.state && typeof json.state === "object") ? json.state : {};
    }
    async function postAction(code, patch){
      const url = `${SYNC_BASE}/action?room=${encodeURIComponent(code)}`;
      const { json } = await fetchJSON(url, {
        method:"POST",
        headers:{ "content-type":"application/json" },
        body: JSON.stringify(patch || {})
      });
      if(!json || !json.ok) throw new Error("ACTION_FAIL");
      return (json.state && typeof json.state === "object") ? json.state : {};
    }

    async function claimTvLockDO(code){
      const deviceId = ensureDeviceId();
      const room = await fetchRoom(code);

      // لو الغرفة فاضية/غير موجودة
      if(!room || Object.keys(room).length === 0) return { ok:false, reason:"ROOM_MISSING" };

      const cur = room.tvLock || null;
      const curDev = cur && cur.deviceId ? String(cur.deviceId) : "";
      const ts = cur && cur.ts ? Number(cur.ts) : 0;

      const EXPIRE_MS = 30 * 60 * 1000;

      const allowed =
        (!curDev) ||
        (curDev === deviceId) ||
        (ts && (Date.now() - ts) > EXPIRE_MS);

      if(!allowed){
        return { ok:false, reason:"LOCKED", by: curDev };
      }

      // حاول نكتب القفل ثم نتحقق
      await postAction(code, { tvLock: { deviceId, ts: Date.now() } });
      const room2 = await fetchRoom(code);
      const cur2 = room2.tvLock || null;
      const dev2 = cur2 && cur2.deviceId ? String(cur2.deviceId) : "";

      if(dev2 !== deviceId){
        return { ok:false, reason:"LOCKED", by: dev2 };
      }

      return { ok:true };
    }

    // UI
    const gameNameEl = document.getElementById("gameName");
    const scoreGreenEl = document.getElementById("scoreGreen");
    const scoreOrangeEl = document.getElementById("scoreOrange");
    const zoomRange = document.getElementById("zoomRange");
    const mapCanvas = document.getElementById("mapCanvas");
    const mapBg = document.getElementById("mapBg");
    const mapSvg = document.getElementById("mapSvg");
    const statusLine = document.getElementById("statusLine");

    const setupOverlay = document.getElementById("setupOverlay");
    const codeInput = document.getElementById("codeInput");
    const startBtn = document.getElementById("startBtn");
    const setupErr = document.getElementById("setupErr");

    const blockedOverlay = document.getElementById("blockedOverlay");
    const reloadBtn = document.getElementById("reloadBtn");

    // Zoom
    zoomRange.addEventListener("input", () => {
      const v = Number(zoomRange.value || 100);
      const z = Math.max(0.85, Math.min(1.30, v/100));
      mapCanvas.style.setProperty("--zoom", String(z));
    });

    // Letters layout (مثل الصورة)
    const LETTERS = [
      ["ش","أ","ث","د","هـ"],
      ["ي","ح","ض","ن","ك"],
      ["غ","ظ","ق","ر","ع"],
      ["هـ","ز","س","ط","و"],
      ["ذ","ل","ب","م","ج"]
    ];

    // Cells refs
    const CELL_POLY = Array.from({length:5}, ()=>Array.from({length:5}, ()=>null));
    const CELL_STATE_CACHE = {}; // key -> st

    function hexPointsPointyTop(cx, cy, r){
      const pts = [];
      for(let i=0;i<6;i++){
        const ang = (Math.PI/180) * (60*i - 30);
        const x = cx + r * Math.cos(ang);
        const y = cy + r * Math.sin(ang);
        pts.push(`${x.toFixed(2)},${y.toFixed(2)}`);
      }
      return pts.join(" ");
    }

    function buildGrid(){
      mapSvg.innerHTML = "";
      const svgNS = "http://www.w3.org/2000/svg";

      const W = 1000, H = 700;
      mapSvg.setAttribute("viewBox", `0 0 ${W} ${H}`);

      const rows = 5, cols = 5;
      const r = 70;
      const dx = r * Math.sqrt(3);
      const dy = r * 1.5;

      const gridW = cols * dx;
      const gridH = (rows - 1) * dy + (2*r);

      const x0 = (W - gridW) / 2 + (dx/2);
      const y0 = (H - gridH) / 2 + r;

      for(let row=0; row<rows; row++){
        for(let col=0; col<cols; col++){
          const cx = x0 + col*dx + ((row%2) ? (dx/2) : 0);
          const cy = y0 + row*dy;

          const poly = document.createElementNS(svgNS, "polygon");
          poly.setAttribute("points", hexPointsPointyTop(cx, cy, r));
          poly.classList.add("cellPoly","s0");
          poly.dataset.r = String(row);
          poly.dataset.c = String(col);

          const txt = document.createElementNS(svgNS, "text");
          txt.setAttribute("x", String(cx));
          txt.setAttribute("y", String(cy+2));
          txt.classList.add("cellText");
          txt.setAttribute("font-size", "40");
          txt.textContent = LETTERS[row][col];

          mapSvg.appendChild(poly);
          mapSvg.appendChild(txt);

          CELL_POLY[row][col] = poly;
          CELL_STATE_CACHE[`${row}-${col}`] = 0;
        }
      }
    }

    function clampRC(r,c){
      if(r<0||r>4||c<0||c>4) return null;
      return {r,c};
    }

    function parseCellKey(key){
      if(!key) return null;

      // r2c3
      let m = String(key).match(/^r(\d+)c(\d+)$/i);
      if(m) return clampRC(Number(m[1]), Number(m[2]));

      // 2_3 أو 2-3 أو 2,3 أو 2:3
      m = String(key).match(/^(\d+)\s*[_\-,:\|]\s*(\d+)$/);
      if(m) return clampRC(Number(m[1]), Number(m[2]));

      return null;
    }

    function setCellState(r,c,st){
      const el = CELL_POLY?.[r]?.[c];
      if(!el) return;
      const s = Math.max(0, Math.min(3, Number(st)||0));
      el.classList.remove("s0","s1","s2","s3");
      el.classList.add("s"+s);
    }

    function applyScores(s){
      const g = Number(s?.green ?? 0);
      const o = Number(s?.orange ?? 0);
      scoreGreenEl.textContent = String(Number.isFinite(g)?g:0);
      scoreOrangeEl.textContent = String(Number.isFinite(o)?o:0);
    }

    function setGameName(name){
      const t = (String(name || "").trim() || "سباق الحروف");
      gameNameEl.textContent = t;
    }

    // ✅ الخرائط (نجرب maps/ أولاً ثم الجذر كاحتياط)
    function mapCandidates(activeMap){
      const n0 = Number(activeMap)||0;
      const n1 = n0 + 1;
      const out = [];

      // المسار الصحيح الحالي بالمستودع
      out.push(`maps/map${n1}.jpeg`);
      out.push(`maps/map${n1}.jpg`);
      out.push(`maps/map${n1}.png`);
      out.push(`maps/map${n1}.webp`);

      // احتياطيات قديمة بالجذر
      const exts = ["png","webp","jpg","jpeg"];
      for(const ext of exts){
        out.push(`map${n0}.${ext}`);
        out.push(`map${n1}.${ext}`);
        out.push(`Map${n0}.${ext}`);
        out.push(`Map${n1}.${ext}`);
      }

      return out.map(x => x + `?v=${encodeURIComponent(ASSET_VERSION)}`);
    }

    function loadMapImage(activeMap){
      const cands = mapCandidates(activeMap);
      let i = 0;

      const tryNext = () => {
        if(i >= cands.length){
          mapBg.removeAttribute("src");
          statusLine.textContent = "لم أجد ملفات الخريطة (تأكد من maps/map1.jpeg..map3.jpeg).";
          return;
        }
        const src = cands[i++];
        const img = new Image();
        img.onload = () => {
          mapBg.src = src;
        };
        img.onerror = () => tryNext();
        img.src = src;
      };

      tryNext();
    }

    function readMapStates(room, activeMap){
      const ms = room.mapStates;
      if(!ms || typeof ms !== "object") return {};
      return ms[String(activeMap)] || ms[activeMap] || {};
    }

    // ===== Overlays =====
    function showSetup(msg){
      setupErr.style.display = msg ? "block" : "none";
      setupErr.textContent = msg || "";
      setupOverlay.style.display = "flex";
      blockedOverlay.style.display = "none";
    }

    function hideSetup(){
      setupOverlay.style.display = "none";
    }

    function showBlocked(msg){
      blockedOverlay.style.display = "flex";
      setupOverlay.style.display = "none";
      document.getElementById("blockedMsg").textContent = msg || "عرض التلفاز مفتوح على جهاز آخر لنفس الغرفة.";
    }

    // ===== Main Loop (DO polling) =====
    let CODE = "";
    let activeMap = 0;
    let lastActiveMap = null;
    let alive = true;

    function applyRoom(room){
      setGameName(room.name);
      applyScores(room.scores || {green:0, orange:0});

      const am = Number(room.activeMap || 0);
      if(lastActiveMap !== am){
        lastActiveMap = am;
        activeMap = am;
        loadMapImage(activeMap);
        // reset cache
        for(let r=0;r<5;r++) for(let c=0;c<5;c++){
          const k = `${r}-${c}`;
          CELL_STATE_CACHE[k] = 0;
          setCellState(r,c,0);
        }
      }

      const mapStates = readMapStates(room, activeMap);

      // تحديث 25 خلية فقط (بدون reset كامل كل مرة)
      for(let r=0;r<5;r++){
        for(let c=0;c<5;c++){
          const key = `${r}-${c}`;
          let st = 0;

          // يدعم مفاتيح "r2c3" أو "2-3" أو "2_3" أو "2:3"
          if(mapStates && typeof mapStates === "object"){
            if(mapStates[key] != null) st = Number(mapStates[key] || 0);
            else{
              // بحث بديل في المفاتيح الموجودة
              // (في حال كانت مفاتيح بصيغة مختلفة)
              // نمر عليها مرة واحدة فقط لو احتجنا
            }
          }

          st = Math.max(0, Math.min(3, Number(st)||0));
          if(CELL_STATE_CACHE[key] !== st){
            CELL_STATE_CACHE[key] = st;
            setCellState(r,c,st);
          }
        }
      }

      // إذا فيه مفاتيح بصيغ ثانية (r2c3 مثلاً) نطبقها هنا:
      if(mapStates && typeof mapStates === "object"){
        for(const [k,v] of Object.entries(mapStates)){
          const rc = parseCellKey(k);
          if(!rc) continue;
          const kk = `${rc.r}-${rc.c}`;
          const st = Math.max(0, Math.min(3, Number(v)||0));
          if(CELL_STATE_CACHE[kk] !== st){
            CELL_STATE_CACHE[kk] = st;
            setCellState(rc.r, rc.c, st);
          }
        }
      }
    }

    async function tick(){
      if(!alive) return;
      try{
        const room = await fetchRoom(CODE);

        if(!room || Object.keys(room).length === 0){
          statusLine.textContent = "الغرفة غير موجودة";
          return;
        }

        applyRoom(room);
        statusLine.textContent = "متصل";

      }catch(e){
        statusLine.textContent = "تعذر الاتصال";
      }
    }

    function loop(){
      if(!alive) return;
      tick();
      const delay = document.hidden ? 1800 : 900;
      setTimeout(loop, delay);
    }

    // ===== Start =====
    async function start(code){
      const c = cleanCode(code);
      if(c.length !== 6){
        showSetup("اكتب رمز غرفة صحيح (6 أرقام)");
        return;
      }

      CODE = c;
      hideSetup();

      if(!CELL_POLY[0][0]) buildGrid();
      statusLine.textContent = "جاري الاتصال...";

      // قفل جهاز واحد (Best-effort عبر DO state)
      try{
        const lock = await claimTvLockDO(CODE);
        if(!lock.ok){
          if(lock.reason === "ROOM_MISSING"){
            showSetup("الغرفة غير موجودة أو لم يتم إنشاؤها بعد.");
            return;
          }
          showBlocked("عرض التلفاز مفتوح على جهاز آخر لهذه الغرفة.");
          return;
        }
      }catch(e){
        showSetup("تعذر الاتصال بالسيرفر. حاول مرة ثانية.");
        return;
      }

      // تحديث القفل كل دقيقة (عشان ما يطول ويُعتبر منتهي)
      const deviceId = ensureDeviceId();
      setInterval(() => {
        if(!alive || !CODE) return;
        postAction(CODE, { tvLock: { deviceId, ts: Date.now() } }).catch(()=>{});
      }, 60 * 1000);

      loop();
    }

    // Buttons
    startBtn.addEventListener("click", () => start(codeInput.value || ""));
    codeInput.addEventListener("keydown", (e) => { if(e.key === "Enter") start(codeInput.value || ""); });
    reloadBtn.addEventListener("click", () => location.reload());

    window.addEventListener("beforeunload", ()=>{ alive = false; });

    // init
    (function init(){
      const qs = new URLSearchParams(location.search);
      const fromUrl = cleanCode(qs.get("code") || "");
      if(fromUrl.length === 6){
        start(fromUrl);
      }else{
        showSetup("");
      }
    })();
  </script>

  <!-- VERSION: tv.html — vTV-DO-NoFirebase-1 -->
</body>
</html>
